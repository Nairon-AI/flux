{
  "description": "Flux workflow hooks: Ralph guards + Brain vault persistence",
  "hooks": {
    "SessionStart": [
      {
        "matcher": "startup|resume",
        "hooks": [
          {
            "type": "command",
            "command": "PLUGIN_ROOT=\"${DROID_PLUGIN_ROOT:-${CLAUDE_PLUGIN_ROOT}}\"; [ -z \"$PLUGIN_ROOT\" ] && PLUGIN_ROOT=$(ls -td ~/.claude/plugins/cache/nairon-flux/flux/*/ 2>/dev/null | head -1); [ -f \"$PLUGIN_ROOT/hooks/inject-brain.sh\" ] && \"$PLUGIN_ROOT/hooks/inject-brain.sh\" || true",
            "timeout": 5
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Bash|Execute",
        "hooks": [
          {
            "type": "command",
            "command": "[ ! -f scripts/ralph/hooks/ralph-guard.py ] || scripts/ralph/hooks/ralph-guard.py",
            "timeout": 5
          }
        ]
      },
      {
        "matcher": "Edit|Write",
        "hooks": [
          {
            "type": "command",
            "command": "[ ! -f scripts/ralph/hooks/ralph-guard.py ] || scripts/ralph/hooks/ralph-guard.py",
            "timeout": 5
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Bash|Execute",
        "hooks": [
          {
            "type": "command",
            "command": "[ ! -f scripts/ralph/hooks/ralph-guard.py ] || scripts/ralph/hooks/ralph-guard.py",
            "timeout": 5
          }
        ]
      },
      {
        "matcher": "brain/",
        "hooks": [
          {
            "type": "command",
            "command": "PLUGIN_ROOT=\"${DROID_PLUGIN_ROOT:-${CLAUDE_PLUGIN_ROOT}}\"; [ -z \"$PLUGIN_ROOT\" ] && PLUGIN_ROOT=$(ls -td ~/.claude/plugins/cache/nairon-flux/flux/*/ 2>/dev/null | head -1); [ -f \"$PLUGIN_ROOT/hooks/auto-index-brain.sh\" ] && \"$PLUGIN_ROOT/hooks/auto-index-brain.sh\" || true",
            "timeout": 5
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "[ ! -f scripts/ralph/hooks/ralph-guard.py ] || scripts/ralph/hooks/ralph-guard.py",
            "timeout": 5
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "[ ! -f scripts/ralph/hooks/ralph-guard.py ] || scripts/ralph/hooks/ralph-guard.py",
            "timeout": 5
          }
        ]
      }
    ]
  }
}
